import{p as A,m as K,a as Q,g as E,u as R,c as a,b as te,d as ae,e as oe,f as le,h as se,t as z,i as ne,j as re,k as ue,l as ie,n as ce,s as w,o as d,q as de,V as W,r as $,v as H,w as ve,x as O,y as me,z as D,A as ge,B as fe,C as he,D as pe,E as be,F as ye,G as _e,H as q,I as ke,J as xe,K as I,L as Ve,M as Se,N as Te,O as Be,P as we,Q as Ce,R as Pe,S as c,T,U as u,W as V,X as k,Y as B,Z as x,_ as Ie,$ as Y,a0 as P,a1 as F,a2 as U,a3 as M,a4 as Ne,a5 as j,a6 as G}from"./index-5ef22765.js";import{_ as Le}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Ae,a as Ee}from"./VNavigationDrawer-7c63a073.js";const X=A({text:String,...K(),...Q()},"VToolbarTitle"),Z=E()({name:"VToolbarTitle",props:X(),setup(e,v){let{slots:t}=v;return R(()=>{const m=!!(t.default||t.text||e.text);return a(e.tag,{class:["v-toolbar-title",e.class],style:e.style},{default:()=>{var l;return[m&&a("div",{class:"v-toolbar-title__placeholder"},[t.text?t.text():e.text,(l=t.default)==null?void 0:l.call(t)])]}})}),{}}}),Re=[null,"prominent","default","comfortable","compact"],ee=A({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>Re.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...te(),...K(),...ae(),...oe(),...Q({tag:"header"}),...le()},"VToolbar"),J=E()({name:"VToolbar",props:ee(),setup(e,v){var r;let{slots:t}=v;const{backgroundColorClasses:m,backgroundColorStyles:l}=se(z(e,"color")),{borderClasses:s}=ne(e),{elevationClasses:g}=re(e),{roundedClasses:b}=ue(e),{themeClasses:y}=ie(e),{rtlClasses:f}=ce(),i=w(!!(e.extended||(r=t.extension)!=null&&r.call(t))),_=d(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),h=d(()=>i.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return de({VBtn:{variant:"text"}}),R(()=>{var o;const n=!!(e.title||t.title),p=!!(t.image||e.image),C=(o=t.extension)==null?void 0:o.call(t);return i.value=!!(e.extended||C),a(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},m.value,s.value,g.value,b.value,y.value,f.value,e.class],style:[l.value,e.style]},{default:()=>[p&&a("div",{key:"image",class:"v-toolbar__image"},[t.image?a($,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},t.image):a(W,{key:"image-img",cover:!0,src:e.image},null)]),a($,{defaults:{VTabs:{height:H(_.value)}}},{default:()=>{var S,N,L;return[a("div",{class:"v-toolbar__content",style:{height:H(_.value)}},[t.prepend&&a("div",{class:"v-toolbar__prepend"},[(S=t.prepend)==null?void 0:S.call(t)]),n&&a(Z,{key:"title",text:e.title},{text:t.title}),(N=t.default)==null?void 0:N.call(t),t.append&&a("div",{class:"v-toolbar__append"},[(L=t.append)==null?void 0:L.call(t)])])]}}),a($,{defaults:{VTabs:{height:H(h.value)}}},{default:()=>[a(ve,null,{default:()=>[i.value&&a("div",{class:"v-toolbar__extension",style:{height:H(h.value)}},[C])]})]})]})}),{contentHeight:_,extensionHeight:h}}}),He=A({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function De(e){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:t}=v;let m=0;const l=O(null),s=w(0),g=w(0),b=w(0),y=w(!1),f=w(!1),i=d(()=>Number(e.scrollThreshold)),_=d(()=>me((i.value-s.value)/i.value||0)),h=()=>{const r=l.value;!r||t&&!t.value||(m=s.value,s.value="window"in r?r.pageYOffset:r.scrollTop,f.value=s.value<m,b.value=Math.abs(s.value-i.value))};return D(f,()=>{g.value=g.value||s.value}),D(y,()=>{g.value=0}),ge(()=>{D(()=>e.scrollTarget,r=>{var p;const n=r?document.querySelector(r):window;n&&n!==l.value&&((p=l.value)==null||p.removeEventListener("scroll",h),l.value=n,l.value.addEventListener("scroll",h,{passive:!0}))},{immediate:!0})}),fe(()=>{var r;(r=l.value)==null||r.removeEventListener("scroll",h)}),t&&D(t,h,{immediate:!0}),{scrollThreshold:i,currentScroll:s,currentThreshold:b,isScrollActive:y,scrollRatio:_,isScrollingUp:f,savedScroll:g}}const Fe=A({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...ee(),...he(),...He(),height:{type:[Number,String],default:64}},"VAppBar"),Ue=E()({name:"VAppBar",props:Fe(),emits:{"update:modelValue":e=>!0},setup(e,v){let{slots:t}=v;const m=O(),l=pe(e,"modelValue"),s=d(()=>{var S;const o=new Set(((S=e.scrollBehavior)==null?void 0:S.split(" "))??[]);return{hide:o.has("hide"),inverted:o.has("inverted"),collapse:o.has("collapse"),elevate:o.has("elevate"),fadeImage:o.has("fade-image")}}),g=d(()=>{const o=s.value;return o.hide||o.inverted||o.collapse||o.elevate||o.fadeImage||!l.value}),{currentScroll:b,scrollThreshold:y,isScrollingUp:f,scrollRatio:i}=De(e,{canScroll:g}),_=d(()=>e.collapse||s.value.collapse&&(s.value.inverted?i.value>0:i.value===0)),h=d(()=>e.flat||s.value.elevate&&(s.value.inverted?b.value>0:b.value===0)),r=d(()=>s.value.fadeImage?s.value.inverted?1-i.value:i.value:void 0),n=d(()=>{var N,L;if(s.value.hide&&s.value.inverted)return 0;const o=((N=m.value)==null?void 0:N.contentHeight)??0,S=((L=m.value)==null?void 0:L.extensionHeight)??0;return o+S});be(d(()=>!!e.scrollBehavior),()=>{ke(()=>{s.value.hide?s.value.inverted?l.value=b.value>y.value:l.value=f.value||b.value<y.value:l.value=!0})});const{ssrBootStyles:p}=ye(),{layoutItemStyles:C}=_e({id:e.name,order:d(()=>parseInt(e.order,10)),position:z(e,"location"),layoutSize:n,elementSize:w(void 0),active:l,absolute:z(e,"absolute")});return R(()=>{const[o]=J.filterProps(e);return a(J,q({ref:m,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...C.value,"--v-toolbar-image-opacity":r.value,height:void 0,...p.value},e.style]},o,{collapse:_.value,flat:h.value}),t)}),{}}}),Me=A({...xe({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),$e=E()({name:"VAppBarNavIcon",props:Me(),setup(e,v){let{slots:t}=v;return R(()=>a(I,q(e,{class:["v-app-bar-nav-icon"]}),t)),{}}}),ze=E()({name:"VAppBarTitle",props:X(),setup(e,v){let{slots:t}=v;return R(()=>a(Z,q(e,{class:"v-app-bar-title"}),t)),{}}}),Oe=""+new URL("ai-friend-logo_darkblue-452f23c4.svg",import.meta.url).href;const qe={__name:"FrontLayout",setup(e){const v=Ve(),t=Se(),m=Te(),{isLogin:l,isAdmin:s}=Be(m),g=we(),{mobile:b}=Ce(),y=d(()=>b.value),f=O(!1),i=d(()=>[{to:"/",text:"HOME",icon:"mdi-home",show:!0},{to:"/topic",text:"探索話題",icon:"mdi-message",show:l.value},{to:"/news",text:"新聞話題",icon:"mdi-newspaper",show:l.value},{to:"/register",text:"註冊",icon:"mdi-account-plus",show:!l.value},{to:"/login",text:"登入",icon:"mdi-login",show:!l.value}]);d(()=>t.params.id);const _=async()=>{try{await j.delete("/users/logout"),m.logout(),g({text:"登出成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),v.push("/")}catch(n){console.log(n),g({text:n.message.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red ",location:"bottom"}})}},h=async()=>{try{const{data:n}=await j.get("conversation/latest");return n.result._id}catch(n){return console.error("Error fetching the latest conversation ID: ",n),null}},r=async()=>{const n=await h();console.log(n),n?v.push(`/conversation/${n}`):(g({text:"您目前尚無創建對話話題，請從探索話題開始選擇話題",showCloseButton:!1,snackbarProps:{timeout:2500,color:"red",location:"bottom"}}),console.error("Failed to navigate to the latest conversation due to missing ID."))};return(n,p)=>{const C=Pe("router-view");return c(),T(B,null,[a(Ue,{color:"#fff"},{default:u(()=>[a(I,{class:"logoBtn",active:!1,to:"/"},{default:u(()=>[a(W,{src:Oe,alt:"logo","max-width":"30%"}),a(ze,{class:"web-title"},{default:u(()=>[x("E-Friend ")]),_:1})]),_:1}),a(Ie),y.value?(c(),V($e,{key:0,active:!1,onClick:p[0]||(p[0]=o=>f.value=!f.value)})):k("",!0),y.value?k("",!0):(c(),T(B,{key:1},[(c(!0),T(B,null,Y(i.value,o=>(c(),T(B,{key:o.to},[o.show?(c(),V(I,{key:0,to:o.to,"prepend-icon":o.icon,exact:""},{default:u(()=>[x(G(o.text),1)]),_:2},1032,["to","prepend-icon"])):k("",!0)],64))),128)),P(l)?(c(),T(B,{key:0},[a(I,{"prepend-icon":"mdi-forum",onClick:r},{default:u(()=>[x("我的對話")]),_:1}),P(s)?(c(),V(I,{key:0,"prepend-icon":"mdi-cog",to:"/admin"},{default:u(()=>[x("管理")]),_:1})):k("",!0),a(I,{"prepend-icon":"mdi-logout",onClick:_},{default:u(()=>[x("登出")]),_:1})],64)):k("",!0)],64))]),_:1}),y.value?(c(),V(Ae,{key:0,modelValue:f.value,"onUpdate:modelValue":p[1]||(p[1]=o=>f.value=o),location:"right",temporary:""},{default:u(()=>[a(Ne,null,{default:u(()=>[(c(!0),T(B,null,Y(i.value,o=>(c(),T(B,{key:o.to},[o.show?(c(),V(F,{key:0,to:o.to,exact:""},{prepend:u(()=>[a(U,{icon:o.icon},null,8,["icon"]),a(M,null,{default:u(()=>[x(G(o.text),1)]),_:2},1024)]),_:2},1032,["to"])):k("",!0)],64))),128)),P(l)?(c(),V(F,{key:0,onClick:r},{prepend:u(()=>[a(U,{icon:"mdi-forum"}),a(M,null,{default:u(()=>[x("我的對話")]),_:1})]),_:1})):k("",!0),P(l)&&P(s)?(c(),V(F,{key:1,to:"/admin"},{prepend:u(()=>[a(U,{icon:"mdi-cog"}),a(M,null,{default:u(()=>[x("管理")]),_:1})]),_:1})):k("",!0),P(l)?(c(),V(F,{key:2,onClick:_},{prepend:u(()=>[a(U,{icon:"mdi-logout"}),a(M,null,{default:u(()=>[x("登出")]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1},8,["modelValue"])):k("",!0),a(Ee,null,{default:u(()=>[a(C)]),_:1})],64)}}},Je=Le(qe,[["__scopeId","data-v-89e0fb26"]]);export{Je as default};
